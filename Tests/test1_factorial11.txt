# Функция, с которой начинается выполнение программы
function main
{
# оператор push кладет на вершину стэка целое число
# или значение переменной
push 11
# Вызов функции factorial с параметром 3
call factorial
# Вызов внешней функции вывода на консоль числа,
# которое находится на вершине стэка. Вершина стэка извлекается.
# Выход из функции
return
}
# Объявление функции вычисления факториала.
# Можно объявлять функции ниже их места использования.
function factorial
{
# Продублируем первый аргумент программы (аргумент n)
peek n
push 0
# Проверим равна ли копия n нулю, если да,
# тогда переходим к метке возврата факториала для нуля.
ifeq zero_factorial
# Аргумент не равен нулю, значит продолжаем вычисление факториала.
# Создадим копию n и уменьшим ее на единицу – это n-1
push 1
push n
sub
# Найдем factorial(n-1)
call factorial
push n
# Найдем произведение n * factorial(n-1)
mul
# Выходим из функции, а на вершине стэка лежит n * factorial(n-1)
return
zero_factorial:
pop
push 1
#10
# Возвращаем управление в вызывающую функцию
return
}
